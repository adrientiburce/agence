os = require('os')
chai = require('chai')
expect = chai.expect
sinon = require('sinon')
chai.use(require('sinon-chai'))
president = require('../lib/president')
windows = require('../lib/windows')
unix = require('../lib/unix')

describe 'President:', ->

	describe '.execute()', ->

		beforeEach ->
			@windowsExecuteStub = sinon.stub(windows, 'executeWithPrivileges')
			@unixExecuteStub = sinon.stub(unix, 'executeWithPrivileges')

		afterEach ->
			@windowsExecuteStub.restore()
			@unixExecuteStub.restore()

		describe 'given windows', ->

			beforeEach ->
				@osPlatformStub = sinon.stub(os, 'platform')
				@osPlatformStub.returns('win32')

			afterEach ->
				@osPlatformStub.restore()

			it 'should assign execute() to the windows option', ->
				president.execute()
				expect(@windowsExecuteStub).to.have.been.calledOnce
				expect(@unixExecuteStub).to.not.have.been.called

		describe 'given darwin', ->

			beforeEach ->
				@osPlatformStub = sinon.stub(os, 'platform')
				@osPlatformStub.returns('darwin')

			afterEach ->
				@osPlatformStub.restore()

			it 'should assign execute() to the unix option', ->
				president.execute()
				expect(@unixExecuteStub).to.have.been.calledOnce
				expect(@windowsExecuteStub).to.not.have.been.called

		describe 'given linux', ->

			beforeEach ->
				@osPlatformStub = sinon.stub(os, 'platform')
				@osPlatformStub.returns('linux')

			afterEach ->
				@osPlatformStub.restore()

			it 'should assign execute() to the unix option', ->
				president.execute()
				expect(@unixExecuteStub).to.have.been.calledOnce
				expect(@windowsExecuteStub).to.not.have.been.called
