child_process = require('child_process')
_ = require('lodash')

exports.executeWithPrivileges = (command, callback) ->

	if not command?
		throw new Error('Missing command argument')

	if not _.isString(command)
		throw new Error('Invalid command argument: not a string')

	if _.isEmpty(command)
		throw new Error('Invalid command argument: empty string')

	if not callback?
		throw new Error('Missing callback argument')

	if not _.isFunction(callback)
		throw new Error('Invalid callback argument: not a function')

	child_process.exec "sudo #{command}", (error, stdout, stderr) ->
		return callback(error) if error?
		return callback(null, stdout, stderr)
