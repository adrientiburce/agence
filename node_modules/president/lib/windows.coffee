_ = require('lodash')
windosu = require('windosu')

exports.executeWithPrivileges = (command, callback) ->

	if not command?
		throw new Error('Missing command argument')

	if not _.isString(command)
		throw new Error('Invalid command argument: not a string')

	if _.isEmpty(command)
		throw new Error('Invalid command argument: empty string')

	if not callback?
		throw new Error('Missing callback argument')

	if not _.isFunction(callback)
		throw new Error('Invalid callback argument: not a function')

	windosu.exec command, (error, output) ->
		return callback(error) if error?
		return callback(null, output, null)
